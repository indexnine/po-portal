<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Purchase Order</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="print.css">
</head>
<body>

<div class="po-wrapper">

<div class="center">
  <img src="assets/logo.png" class="logo-print">
  <h2>PURCHASE ORDER</h2>
</div>

<div class="header-grid">
  <div><strong>PO No:</strong><br><span id="poNo"></span></div>
  <div><strong>Date:</strong><br><span id="poDate"></span></div>
</div>

<div class="two-col">
  <div>
    <strong>Consignee (Bill To / Ship To)</strong><br>
    <strong>Indexnine Technologies Private Limited</strong><br>
    12th Floor, Sadanand Business Center<br>
    Pashan Highwayy Side Rd<br>
    PUNE - 411007<br>
    Maharashtra, INDIA<br>
    GSTIN/UIN:27AADCI7588M1ZR<br>
    State Name : Maharashtra, Code : 27
  </div>
  <div>
    <strong>Supplier</strong><br>
    <span id="supplier"></span>
  </div>
</div>

<table class="items">
<thead>
<tr>
<th>#</th><th>Particulars</th><th>Qty</th><th class="money">Rate (₹)</th><th class="money">Amount (₹)</th>
</tr>
</thead>
<tbody id="itemsBody"></tbody>
<tr><td colspan="3"></td><td>Sub Total</td><td class="money">₹ <span id="subTotal"></span></td></tr>
<tr><td colspan="3"></td><td>CGST (9%)</td><td class="money">₹ <span id="cgstAmt"></span></td></tr>
<tr><td colspan="3"></td><td>SGST (9%)</td><td class="money">₹ <span id="sgstAmt"></span></td></tr>
<tr class="grand"><td colspan="3"></td><td>Total</td><td class="money">₹ <span id="grandTotal"></span></td></tr>
</table>

<div class="bottom-grid">
  <div>
    <strong>Amount in Words:</strong><br>
    <span id="words"></span><br><br>
    <strong>Terms & Conditions</strong><br>
    <span id="termsText"></span>
  </div>

  <div class="sign-right">
    for Indexnine Technologies Private Limited<br>
    <img src="assets/stamp.png" class="stamp"><br>
    <strong>Authorised Signatory</strong>
  </div>
</div>

<button onclick="window.print()" class="print-btn">Print / Save PDF</button>

</div>

<script>
const d = JSON.parse(localStorage.getItem("poData")||"{}");
if(d.poNo){
  poNo.innerText=d.poNo;
  poDate.innerText=d.poDate;
  supplier.innerText=d.supplier;
  termsText.innerText=d.terms||"—";
  words.innerText=d.totalWords;
  let sub=0;
  d.items.forEach((i,idx)=>{
    const amt=i.qty*i.rate;
    sub+=amt;
    itemsBody.innerHTML+=`
      <tr>
        <td>${idx+1}</td>
        <td>${i.name}</td>
        <td style="text-align:right">${i.qty}</td>
        <td class="money">₹ ${i.rate}</td>
        <td class="money">₹ ${amt.toFixed(2)}</td>
      </tr>`;
  });
  const cgst=sub*0.09, sgst=sub*0.09;
  subTotal.innerText=sub.toFixed(2);
  cgstAmt.innerText=cgst.toFixed(2);
  sgstAmt.innerText=sgst.toFixed(2);
  grandTotal.innerText=(sub+cgst+sgst).toFixed(2);
}
</script>

</body>
</html>
