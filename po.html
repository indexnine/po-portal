<!DOCTYPE html>
<html>
<head>
<title>PO</title>
<link rel="stylesheet" href="print.css">
</head>
<body>

<div class="po-wrapper">

<img src="assets/logo.png" class="logo-print">

<h2>PURCHASE ORDER</h2>

<div class="header-grid">
<div>
<b>PO No:</b> <span id="pno"></span>
</div>
<div>
<b>Date:</b> <span id="pdt"></span>
</div>
</div>

<div class="two-col">
<div>
<b>Consignee</b><br>
Indexnine Technologies Pvt. Ltd.
</div>
<div>
<b>Supplier</b><br>
<span id="sup"></span>
</div>
</div>

<table class="items" id="ptbl">
<tr>
<th>#</th><th>Particulars</th><th>Qty</th><th>Rate (₹)</th><th>Amount (₹)</th>
</tr>
</table>

<div class="bottom-grid">
<div>
<b>Amount in Words:</b><br><span id="wrd"></span><br><br>
<b>Terms & Conditions</b><br><span id="trm"></span>
</div>

<div class="sign-right">
For Indexnine Technologies Pvt. Ltd.<br><br>
<img src="assets/stamp.png" class="stamp"><br>
<b>Authorised Signatory</b>
</div>
</div>

<button onclick="window.print()" class="print-btn">Print / Save PDF</button>

</div>

<script>
const d=JSON.parse(localStorage.getItem("poData"));
pno.innerText=d.poNo;
pdt.innerText=d.poDate;
sup.innerText=d.supplier;
wrd.innerText=d.words;
trm.innerText=d.terms;

let sub=0;

d.items.forEach((it,i)=>{
const amt=Math.round(it.q*it.r);
sub+=amt;

ptbl.innerHTML+=`
<tr>
<td>${i+1}</td>
<td>${it.n}</td>
<td>${it.q}</td>
<td class="money">₹ ${Number(it.r).toLocaleString("en-IN")}</td>
<td class="money">₹ ${amt.toLocaleString("en-IN")}</td>
</tr>`;
});

const tax=Math.round(sub*0.18);
const tot=sub+tax;

ptbl.innerHTML+=`
<tr><td colspan="4">Sub Total</td><td class="money">₹ ${sub.toLocaleString("en-IN")}</td></tr>
<tr><td colspan="4">Tax</td><td class="money">₹ ${tax.toLocaleString("en-IN")}</td></tr>
<tr><td colspan="4"><b>Total</b></td><td class="money"><b>₹ ${tot.toLocaleString("en-IN")}</b></td></tr>
`;
</script>

</body>
</html>
